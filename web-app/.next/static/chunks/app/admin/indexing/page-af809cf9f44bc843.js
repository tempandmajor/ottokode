(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6602],{8404:function(e,r,t){Promise.resolve().then(t.bind(t,1170))},1170:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return b}});var n=t(7437),s=t(2265),i=t(2811),a=t(5526),l=t(2381),o=t(9820),d=t(3675),c=t(5060),u=t(279),f=t(9174),h=t(1817),x=t(9205);let m=(0,x.Z)("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);var p=t(1723);let g=(0,x.Z)("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);var v=t(4438);function b(){let{user:e}=(0,i.a)(),[r,t]=(0,s.useState)(!1),[x,b]=(0,s.useState)(!0),[j,y]=(0,s.useState)(!1),[N,w]=(0,s.useState)(null),[k,S]=(0,s.useState)(0),[E,_]=(0,s.useState)([{path:"README.md",content:"# Sample README\n\nThis is a test file for indexing."},{path:"src/utils.ts",content:'export function formatDate(date: Date): string {\n  return date.toISOString().split("T")[0]\n}'}]),[C,A]=(0,s.useState)("admin-test"),I=(0,s.useCallback)(async()=>{var r,n;if(!e){b(!1);return}t(!!(["your-admin-email@domain.com"].includes(e.email||"")||null!==(n=null===(r=e.email)||void 0===r?void 0:r.endsWith("@ottokode.com"))&&void 0!==n&&n)),b(!1)},[e]);async function P(){try{let e=(0,a.e)(),{data:r,error:t}=await e.from("ai_index_status").select("*").order("id",{ascending:!1}).limit(1).single();if(t&&"PGRST116"!==t.code){console.error("Error fetching index status:",t);return}w(r)}catch(e){console.error("Error fetching index status:",e)}}async function R(){try{let e=(0,a.e)(),{count:r,error:t}=await e.from("ai_embeddings").select("*",{count:"exact",head:!0});t||S(r||0)}catch(e){console.error("Error fetching embeddings count:",e)}}async function Z(){if(e&&0!==E.length){y(!0);try{let e=(0,a.e)(),{data:{session:r}}=await e.auth.getSession();if(!(null==r?void 0:r.access_token))throw Error("No valid session found");let t=await fetch("https://gbugafddunddrvkvgifl.functions.supabase.co/index-repo",{method:"POST",headers:{Authorization:"Bearer ".concat(r.access_token),"Content-Type":"application/json"},body:JSON.stringify({mode:"files",files:E,filterPath:C||null})}),n=await t.json();if(!t.ok)throw Error(n.error||"Indexing failed");v.Am.success("Successfully indexed ".concat(n.indexed_chunks," chunks from ").concat(n.files_processed," files!")),await P(),await R()}catch(e){console.error("Indexing error:",e),v.Am.error(e instanceof Error?e.message:"Indexing failed")}finally{y(!1)}}}function F(e,r,t){let n=[...E];n[e][r]=t,_(n)}return(0,s.useEffect)(()=>{I(),P(),R()},[e,I]),x?(0,n.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,n.jsx)(h.Z,{className:"h-8 w-8 animate-spin"})}):e?r?(0,n.jsxs)("div",{className:"container mx-auto p-6 max-w-4xl",children:[(0,n.jsxs)("div",{className:"mb-8",children:[(0,n.jsx)("h1",{className:"text-3xl font-bold",children:"AI Repo Indexing"}),(0,n.jsx)("p",{className:"text-muted-foreground mt-2",children:"Upload files to index for AI-powered context-aware suggestions"})]}),(0,n.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-8",children:[(0,n.jsx)(o.Zb,{children:(0,n.jsx)(o.aY,{className:"p-4",children:(0,n.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,n.jsx)(m,{className:"h-5 w-5 text-blue-500"}),(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"text-sm font-medium",children:"Total Embeddings"}),(0,n.jsx)("p",{className:"text-2xl font-bold",children:k})]})]})})}),(0,n.jsx)(o.Zb,{children:(0,n.jsx)(o.aY,{className:"p-4",children:(0,n.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,n.jsx)(p.Z,{className:"h-5 w-5 text-green-500"}),(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"text-sm font-medium",children:"Last Indexed"}),(0,n.jsx)("p",{className:"text-sm text-muted-foreground",children:(null==N?void 0:N.last_run)?new Date(N.last_run).toLocaleString():"Never"})]})]})})}),(0,n.jsx)(o.Zb,{children:(0,n.jsx)(o.aY,{className:"p-4",children:(0,n.jsx)("div",{className:"flex items-center space-x-2",children:(0,n.jsx)(f.C,{variant:N?"default":"secondary",children:N?"Initialized":"Not Initialized"})})})})]}),(0,n.jsxs)(o.Zb,{children:[(0,n.jsxs)(o.Ol,{children:[(0,n.jsxs)(o.ll,{className:"flex items-center space-x-2",children:[(0,n.jsx)(g,{className:"h-5 w-5"}),(0,n.jsx)("span",{children:"Index Files"})]}),(0,n.jsx)(o.SZ,{children:"Upload and index files for AI context retrieval. Files will be chunked and embedded."})]}),(0,n.jsxs)(o.aY,{className:"space-y-6",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)(c._,{htmlFor:"filterPath",children:"Repository Path (optional)"}),(0,n.jsx)(u.I,{id:"filterPath",value:C,onChange:e=>A(e.target.value),placeholder:"e.g., 'web-app' or 'main-repo'",className:"mt-1"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(c._,{children:"Files to Index"}),(0,n.jsx)("div",{className:"space-y-4 mt-2",children:E.map((e,r)=>(0,n.jsxs)("div",{className:"border rounded-lg p-4 space-y-3",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsx)(u.I,{placeholder:"File path (e.g., 'src/utils.ts')",value:e.path,onChange:e=>F(r,"path",e.target.value),className:"flex-1 mr-2"}),(0,n.jsx)(l.z,{variant:"ghost",size:"sm",onClick:()=>{_(E.filter((e,t)=>t!==r))},disabled:1===E.length,children:"Remove"})]}),(0,n.jsx)(d.g,{placeholder:"File content...",value:e.content,onChange:e=>F(r,"content",e.target.value),rows:6})]},r))}),(0,n.jsx)(l.z,{variant:"outline",onClick:function(){_([...E,{path:"",content:""}])},className:"mt-4",children:"Add Another File"})]}),(0,n.jsxs)("div",{className:"flex space-x-4",children:[(0,n.jsxs)(l.z,{onClick:Z,disabled:j||0===E.length||E.some(e=>!e.path||!e.content),className:"flex items-center space-x-2",children:[j&&(0,n.jsx)(h.Z,{className:"h-4 w-4 animate-spin"}),(0,n.jsx)("span",{children:j?"Indexing...":"Index Files"})]}),(0,n.jsx)(l.z,{variant:"outline",onClick:()=>{P(),R()},children:"Refresh Status"})]})]})]}),(0,n.jsxs)(o.Zb,{className:"mt-6",children:[(0,n.jsx)(o.Ol,{children:(0,n.jsx)(o.ll,{children:"Setup Instructions"})}),(0,n.jsx)(o.aY,{children:(0,n.jsxs)("div",{className:"space-y-3 text-sm",children:[(0,n.jsx)("p",{children:(0,n.jsx)("strong",{children:"1. Deploy Edge Function:"})}),(0,n.jsxs)("ul",{className:"list-disc list-inside ml-4 space-y-1",children:[(0,n.jsx)("li",{children:"Go to Supabase Dashboard â†’ Edge Functions"}),(0,n.jsx)("li",{children:'Create new function named "index-repo"'}),(0,n.jsxs)("li",{children:["Copy contents from ",(0,n.jsx)("code",{children:"supabase/functions/index-repo/index.ts"})]})]}),(0,n.jsx)("p",{children:(0,n.jsx)("strong",{children:"2. Set Environment Variables:"})}),(0,n.jsxs)("ul",{className:"list-disc list-inside ml-4 space-y-1",children:[(0,n.jsx)("li",{children:(0,n.jsx)("code",{children:"SUPABASE_URL=https://gbugafddunddrvkvgifl.supabase.co"})}),(0,n.jsx)("li",{children:(0,n.jsx)("code",{children:"SUPABASE_SERVICE_ROLE_KEY=your_service_key"})}),(0,n.jsxs)("li",{children:[(0,n.jsx)("code",{children:"OPENAI_API_KEY=your_openai_key"})," (optional)"]})]}),(0,n.jsx)("p",{children:(0,n.jsx)("strong",{children:"3. Test URL:"})}),(0,n.jsx)("code",{className:"block bg-muted p-2 rounded",children:"https://gbugafddunddrvkvgifl.functions.supabase.co/index-repo"})]})})]})]}):(0,n.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,n.jsx)(o.Zb,{className:"w-96",children:(0,n.jsx)(o.aY,{className:"pt-6",children:(0,n.jsx)("p",{className:"text-center text-muted-foreground",children:"Access denied. Admin privileges required."})})})}):(0,n.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,n.jsx)(o.Zb,{className:"w-96",children:(0,n.jsx)(o.aY,{className:"pt-6",children:(0,n.jsx)("p",{className:"text-center text-muted-foreground",children:"Please log in to access admin features."})})})})}},1723:function(e,r,t){"use strict";t.d(r,{Z:function(){return n}});let n=(0,t(9205).Z)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])},1817:function(e,r,t){"use strict";t.d(r,{Z:function(){return n}});let n=(0,t(9205).Z)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},2811:function(e,r,t){"use strict";t.d(r,{AuthProvider:function(){return l},a:function(){return o}});var n=t(7437),s=t(2265),i=t(5526);let a=(0,s.createContext)(void 0);function l(e){let{children:r}=e,[t,l]=(0,s.useState)(null),[o,d]=(0,s.useState)(null),[c,u]=(0,s.useState)(!0);(0,s.useEffect)(()=>{let e=(0,i.e)();e.auth.getSession().then(e=>{var r;let{data:{session:t},error:n}=e;if(n)throw console.error("Error getting session:",n),n;d(t),l(null!==(r=null==t?void 0:t.user)&&void 0!==r?r:null),u(!1)}).catch(e=>{console.error("Auth initialization error:",e),u(!1)});let{data:{subscription:r}}=e.auth.onAuthStateChange(async(r,t)=>{var n,s,i;if(d(t),l(null!==(n=null==t?void 0:t.user)&&void 0!==n?n:null),u(!1),"SIGNED_IN"===r&&(null==t?void 0:t.user))try{let{data:r,error:n}=await e.from("users").select("id").eq("id",t.user.id).single();if(n&&"PGRST116"!==n.code){console.error("Error checking existing user:",n);return}if(!r){let{error:r}=await e.from("users").insert({id:t.user.id,email:t.user.email,name:(null===(s=t.user.user_metadata)||void 0===s?void 0:s.full_name)||(null===(i=t.user.email)||void 0===i?void 0:i.split("@")[0]),color:function(){let e=["#8B5CF6","#06B6D4","#10B981","#F59E0B","#EF4444","#EC4899","#84CC16","#6366F1","#F97316","#14B8A6"];return e[Math.floor(Math.random()*e.length)]}()});r&&console.error("Error creating user profile:",r)}}catch(e){console.error("Error handling user profile:",e)}});return()=>r.unsubscribe()},[]);let f=async(e,r)=>{let t=(0,i.e)(),{error:n}=await t.auth.signInWithPassword({email:e,password:r});return{error:n}},h=async(e,r,t)=>{let n=(0,i.e)(),{error:s}=await n.auth.signUp({email:e,password:r,options:{data:{full_name:t}}});return{error:s}},x=async()=>{let e=(0,i.e)();await e.auth.signOut()},m=async()=>{let e=(0,i.e)(),{error:r}=await e.auth.signInWithOAuth({provider:"github",options:{redirectTo:"".concat(window.location.origin,"/ide")}});return{error:r}};return(0,n.jsx)(a.Provider,{value:{user:t,session:o,loading:c,signIn:f,signUp:h,signOut:x,signInWithGithub:m},children:r})}function o(){let e=(0,s.useContext)(a);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},9174:function(e,r,t){"use strict";t.d(r,{C:function(){return l}});var n=t(7437);t(2265);var s=t(535),i=t(3448);let a=(0,s.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function l(e){let{className:r,variant:t,...s}=e;return(0,n.jsx)("div",{className:(0,i.cn)(a({variant:t}),r),...s})}},2381:function(e,r,t){"use strict";t.d(r,{z:function(){return d}});var n=t(7437),s=t(2265),i=t(7053),a=t(535),l=t(3448);let o=(0,a.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline",hero:"bg-white text-black hover:bg-white/90 hover:shadow-lg transform hover:scale-105 transition-all duration-300 border border-white/20"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),d=s.forwardRef((e,r)=>{let{className:t,variant:s,size:a,asChild:d=!1,...c}=e,u=d?i.g7:"button";return(0,n.jsx)(u,{className:(0,l.cn)(o({variant:s,size:a,className:t})),ref:r,...c})});d.displayName="Button"},9820:function(e,r,t){"use strict";t.d(r,{Ol:function(){return l},SZ:function(){return d},Zb:function(){return a},aY:function(){return c},ll:function(){return o}});var n=t(7437),s=t(2265),i=t(3448);let a=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,n.jsx)("div",{ref:r,className:(0,i.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",t),...s})});a.displayName="Card";let l=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,n.jsx)("div",{ref:r,className:(0,i.cn)("flex flex-col space-y-1.5 p-6",t),...s})});l.displayName="CardHeader";let o=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,n.jsx)("h3",{ref:r,className:(0,i.cn)("text-2xl font-semibold leading-none tracking-tight",t),...s})});o.displayName="CardTitle";let d=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,n.jsx)("p",{ref:r,className:(0,i.cn)("text-sm text-muted-foreground",t),...s})});d.displayName="CardDescription";let c=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,n.jsx)("div",{ref:r,className:(0,i.cn)("p-6 pt-0",t),...s})});c.displayName="CardContent",s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,n.jsx)("div",{ref:r,className:(0,i.cn)("flex items-center p-6 pt-0",t),...s})}).displayName="CardFooter"},279:function(e,r,t){"use strict";t.d(r,{I:function(){return a}});var n=t(7437),s=t(2265),i=t(3448);let a=s.forwardRef((e,r)=>{let{className:t,type:s,...a}=e;return(0,n.jsx)("input",{type:s,className:(0,i.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),ref:r,...a})});a.displayName="Input"},5060:function(e,r,t){"use strict";t.d(r,{_:function(){return d}});var n=t(7437),s=t(2265),i=t(6394),a=t(535),l=t(3448);let o=(0,a.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),d=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,n.jsx)(i.f,{ref:r,className:(0,l.cn)(o(),t),...s})});d.displayName=i.f.displayName},3675:function(e,r,t){"use strict";t.d(r,{g:function(){return a}});var n=t(7437),s=t(2265),i=t(3448);let a=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,n.jsx)("textarea",{className:(0,i.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),ref:r,...s})});a.displayName="Textarea"},5526:function(e,r,t){"use strict";t.d(r,{e:function(){return a}});var n=t(8439);let s={auth:{getSession:()=>Promise.resolve({data:{session:null},error:null}),signInWithPassword:()=>Promise.resolve({data:{user:null,session:null},error:Error("Supabase not configured")}),signUp:()=>Promise.resolve({data:{user:null,session:null},error:Error("Supabase not configured")}),signOut:()=>Promise.resolve({error:null}),onAuthStateChange:()=>({data:{subscription:{unsubscribe:()=>{}}}})},from:()=>({select:()=>({data:[],error:null}),insert:()=>Promise.resolve({data:null,error:Error("Supabase not configured")}),update:()=>Promise.resolve({data:null,error:Error("Supabase not configured")}),delete:()=>Promise.resolve({data:null,error:Error("Supabase not configured")})})},i=null;function a(){let e="your_supabase_url_here",r="your_supabase_anon_key_here";if(e.includes("placeholder")||r.includes("placeholder"))return s;if(i)return i;try{let t=!!e&&/^https:\/\/.+supabase\.co$/i.test(e),s=!!r&&r.length>10;if(t&&s)return i=(0,n.eI)(e,r)}catch(e){}return i=s}},3448:function(e,r,t){"use strict";t.d(r,{cn:function(){return i}});var n=t(1994),s=t(3335);function i(){for(var e=arguments.length,r=Array(e),t=0;t<e;t++)r[t]=arguments[t];return(0,s.m6)((0,n.W)(r))}},6394:function(e,r,t){"use strict";t.d(r,{f:function(){return l}});var n=t(2265),s=t(6840),i=t(7437),a=n.forwardRef((e,r)=>(0,i.jsx)(s.WV.label,{...e,ref:r,onMouseDown:r=>{var t;r.target.closest("button, input, select, textarea")||(null===(t=e.onMouseDown)||void 0===t||t.call(e,r),!r.defaultPrevented&&r.detail>1&&r.preventDefault())}}));a.displayName="Label";var l=a},6840:function(e,r,t){"use strict";t.d(r,{WV:function(){return l},jH:function(){return o}});var n=t(2265),s=t(4887),i=t(7053),a=t(7437),l=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((e,r)=>{let t=(0,i.Z8)(`Primitive.${r}`),s=n.forwardRef((e,n)=>{let{asChild:s,...i}=e,l=s?t:r;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,a.jsx)(l,{...i,ref:n})});return s.displayName=`Primitive.${r}`,{...e,[r]:s}},{});function o(e,r){e&&s.flushSync(()=>e.dispatchEvent(r))}}},function(e){e.O(0,[9203,8439,4438,2971,2117,1744],function(){return e(e.s=8404)}),_N_E=e.O()}]);