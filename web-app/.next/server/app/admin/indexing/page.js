(()=>{var e={};e.id=602,e.ids=[602],e.modules={2885:e=>{"use strict";e.exports=require("@supabase/supabase-js")},2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},3684:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>n.Z,__next_app__:()=>x,originalPathname:()=>c,pages:()=>o,routeModule:()=>u,tree:()=>d}),t(6568),t(1616),t(6560);var a=t(3191),r=t(8716),n=t(8001),i=t(5231),l={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>i[e]);t.d(s,l);let d=["",{children:["admin",{children:["indexing",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,6568)),"/Users/emmanuelakangbou/ai-ide/web-app/app/admin/indexing/page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,1616)),"/Users/emmanuelakangbou/ai-ide/web-app/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(t.bind(t,6560)),"/Users/emmanuelakangbou/ai-ide/web-app/app/not-found.tsx"]}],o=["/Users/emmanuelakangbou/ai-ide/web-app/app/admin/indexing/page.tsx"],c="/admin/indexing/page",x={require:t,loadChunk:()=>Promise.resolve()},u=new a.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/admin/indexing/page",pathname:"/admin/indexing",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},1044:(e,s,t)=>{Promise.resolve().then(t.bind(t,228))},228:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>b});var a=t(326),r=t(7577),n=t(6203),i=t(2777),l=t(1664),d=t(9752),o=t(2015),c=t(4794),x=t(1190),u=t(8443),m=t(7506),p=t(2881);let f=(0,p.Z)("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);var h=t(8998);let g=(0,p.Z)("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);var j=t(5999);function b(){let{user:e}=(0,n.a)(),[s,t]=(0,r.useState)(!1),[p,b]=(0,r.useState)(!0),[v,y]=(0,r.useState)(!1),[N,w]=(0,r.useState)(null),[k,_]=(0,r.useState)(0),[S,P]=(0,r.useState)([{path:"README.md",content:"# Sample README\n\nThis is a test file for indexing."},{path:"src/utils.ts",content:'export function formatDate(date: Date): string {\n  return date.toISOString().split("T")[0]\n}'}]),[E,C]=(0,r.useState)("admin-test");async function A(){try{let e=(0,i.e)(),{data:s,error:t}=await e.from("ai_index_status").select("*").order("id",{ascending:!1}).limit(1).single();if(t&&"PGRST116"!==t.code){console.error("Error fetching index status:",t);return}w(s)}catch(e){console.error("Error fetching index status:",e)}}async function I(){try{let e=(0,i.e)(),{count:s,error:t}=await e.from("ai_embeddings").select("*",{count:"exact",head:!0});t||_(s||0)}catch(e){console.error("Error fetching embeddings count:",e)}}async function R(){if(e&&0!==S.length){y(!0);try{let e=(0,i.e)(),{data:{session:s}}=await e.auth.getSession();if(!s?.access_token)throw Error("No valid session found");let t=await fetch("https://gbugafddunddrvkvgifl.functions.supabase.co/index-repo",{method:"POST",headers:{Authorization:`Bearer ${s.access_token}`,"Content-Type":"application/json"},body:JSON.stringify({mode:"files",files:S,filterPath:E||null})}),a=await t.json();if(!t.ok)throw Error(a.error||"Indexing failed");j.Am.success(`Successfully indexed ${a.indexed_chunks} chunks from ${a.files_processed} files!`),await A(),await I()}catch(e){console.error("Indexing error:",e),j.Am.error(e instanceof Error?e.message:"Indexing failed")}finally{y(!1)}}}function Z(e,s,t){let a=[...S];a[e][s]=t,P(a)}return(0,r.useCallback)(async()=>{if(!e){b(!1);return}t(!!(["your-admin-email@domain.com"].includes(e.email||"")||e.email?.endsWith("@ottokode.com"))),b(!1)},[e]),p?a.jsx("div",{className:"flex items-center justify-center min-h-screen",children:a.jsx(m.Z,{className:"h-8 w-8 animate-spin"})}):e?s?(0,a.jsxs)("div",{className:"container mx-auto p-6 max-w-4xl",children:[(0,a.jsxs)("div",{className:"mb-8",children:[a.jsx("h1",{className:"text-3xl font-bold",children:"AI Repo Indexing"}),a.jsx("p",{className:"text-muted-foreground mt-2",children:"Upload files to index for AI-powered context-aware suggestions"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-8",children:[a.jsx(d.Zb,{children:a.jsx(d.aY,{className:"p-4",children:(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[a.jsx(f,{className:"h-5 w-5 text-blue-500"}),(0,a.jsxs)("div",{children:[a.jsx("p",{className:"text-sm font-medium",children:"Total Embeddings"}),a.jsx("p",{className:"text-2xl font-bold",children:k})]})]})})}),a.jsx(d.Zb,{children:a.jsx(d.aY,{className:"p-4",children:(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[a.jsx(h.Z,{className:"h-5 w-5 text-green-500"}),(0,a.jsxs)("div",{children:[a.jsx("p",{className:"text-sm font-medium",children:"Last Indexed"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:N?.last_run?new Date(N.last_run).toLocaleString():"Never"})]})]})})}),a.jsx(d.Zb,{children:a.jsx(d.aY,{className:"p-4",children:a.jsx("div",{className:"flex items-center space-x-2",children:a.jsx(u.C,{variant:N?"default":"secondary",children:N?"Initialized":"Not Initialized"})})})})]}),(0,a.jsxs)(d.Zb,{children:[(0,a.jsxs)(d.Ol,{children:[(0,a.jsxs)(d.ll,{className:"flex items-center space-x-2",children:[a.jsx(g,{className:"h-5 w-5"}),a.jsx("span",{children:"Index Files"})]}),a.jsx(d.SZ,{children:"Upload and index files for AI context retrieval. Files will be chunked and embedded."})]}),(0,a.jsxs)(d.aY,{className:"space-y-6",children:[(0,a.jsxs)("div",{children:[a.jsx(c._,{htmlFor:"filterPath",children:"Repository Path (optional)"}),a.jsx(x.I,{id:"filterPath",value:E,onChange:e=>C(e.target.value),placeholder:"e.g., 'web-app' or 'main-repo'",className:"mt-1"})]}),(0,a.jsxs)("div",{children:[a.jsx(c._,{children:"Files to Index"}),a.jsx("div",{className:"space-y-4 mt-2",children:S.map((e,s)=>(0,a.jsxs)("div",{className:"border rounded-lg p-4 space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[a.jsx(x.I,{placeholder:"File path (e.g., 'src/utils.ts')",value:e.path,onChange:e=>Z(s,"path",e.target.value),className:"flex-1 mr-2"}),a.jsx(l.z,{variant:"ghost",size:"sm",onClick:()=>{P(S.filter((e,t)=>t!==s))},disabled:1===S.length,children:"Remove"})]}),a.jsx(o.g,{placeholder:"File content...",value:e.content,onChange:e=>Z(s,"content",e.target.value),rows:6})]},s))}),a.jsx(l.z,{variant:"outline",onClick:function(){P([...S,{path:"",content:""}])},className:"mt-4",children:"Add Another File"})]}),(0,a.jsxs)("div",{className:"flex space-x-4",children:[(0,a.jsxs)(l.z,{onClick:R,disabled:v||0===S.length||S.some(e=>!e.path||!e.content),className:"flex items-center space-x-2",children:[v&&a.jsx(m.Z,{className:"h-4 w-4 animate-spin"}),a.jsx("span",{children:v?"Indexing...":"Index Files"})]}),a.jsx(l.z,{variant:"outline",onClick:()=>{A(),I()},children:"Refresh Status"})]})]})]}),(0,a.jsxs)(d.Zb,{className:"mt-6",children:[a.jsx(d.Ol,{children:a.jsx(d.ll,{children:"Setup Instructions"})}),a.jsx(d.aY,{children:(0,a.jsxs)("div",{className:"space-y-3 text-sm",children:[a.jsx("p",{children:a.jsx("strong",{children:"1. Deploy Edge Function:"})}),(0,a.jsxs)("ul",{className:"list-disc list-inside ml-4 space-y-1",children:[a.jsx("li",{children:"Go to Supabase Dashboard â†’ Edge Functions"}),a.jsx("li",{children:'Create new function named "index-repo"'}),(0,a.jsxs)("li",{children:["Copy contents from ",a.jsx("code",{children:"supabase/functions/index-repo/index.ts"})]})]}),a.jsx("p",{children:a.jsx("strong",{children:"2. Set Environment Variables:"})}),(0,a.jsxs)("ul",{className:"list-disc list-inside ml-4 space-y-1",children:[a.jsx("li",{children:a.jsx("code",{children:"SUPABASE_URL=https://gbugafddunddrvkvgifl.supabase.co"})}),a.jsx("li",{children:a.jsx("code",{children:"SUPABASE_SERVICE_ROLE_KEY=your_service_key"})}),(0,a.jsxs)("li",{children:[a.jsx("code",{children:"OPENAI_API_KEY=your_openai_key"})," (optional)"]})]}),a.jsx("p",{children:a.jsx("strong",{children:"3. Test URL:"})}),a.jsx("code",{className:"block bg-muted p-2 rounded",children:"https://gbugafddunddrvkvgifl.functions.supabase.co/index-repo"})]})})]})]}):a.jsx("div",{className:"flex items-center justify-center min-h-screen",children:a.jsx(d.Zb,{className:"w-96",children:a.jsx(d.aY,{className:"pt-6",children:a.jsx("p",{className:"text-center text-muted-foreground",children:"Access denied. Admin privileges required."})})})}):a.jsx("div",{className:"flex items-center justify-center min-h-screen",children:a.jsx(d.Zb,{className:"w-96",children:a.jsx(d.aY,{className:"pt-6",children:a.jsx("p",{className:"text-center text-muted-foreground",children:"Please log in to access admin features."})})})})}},8998:(e,s,t)=>{"use strict";t.d(s,{Z:()=>a});let a=(0,t(2881).Z)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])},7506:(e,s,t)=>{"use strict";t.d(s,{Z:()=>a});let a=(0,t(2881).Z)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},8443:(e,s,t)=>{"use strict";t.d(s,{C:()=>l});var a=t(326);t(7577);var r=t(9360),n=t(1223);let i=(0,r.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function l({className:e,variant:s,...t}){return a.jsx("div",{className:(0,n.cn)(i({variant:s}),e),...t})}},9752:(e,s,t)=>{"use strict";t.d(s,{Ol:()=>l,SZ:()=>o,Zb:()=>i,aY:()=>c,ll:()=>d});var a=t(326),r=t(7577),n=t(1223);let i=r.forwardRef(({className:e,...s},t)=>a.jsx("div",{ref:t,className:(0,n.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",e),...s}));i.displayName="Card";let l=r.forwardRef(({className:e,...s},t)=>a.jsx("div",{ref:t,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",e),...s}));l.displayName="CardHeader";let d=r.forwardRef(({className:e,...s},t)=>a.jsx("h3",{ref:t,className:(0,n.cn)("text-2xl font-semibold leading-none tracking-tight",e),...s}));d.displayName="CardTitle";let o=r.forwardRef(({className:e,...s},t)=>a.jsx("p",{ref:t,className:(0,n.cn)("text-sm text-muted-foreground",e),...s}));o.displayName="CardDescription";let c=r.forwardRef(({className:e,...s},t)=>a.jsx("div",{ref:t,className:(0,n.cn)("p-6 pt-0",e),...s}));c.displayName="CardContent",r.forwardRef(({className:e,...s},t)=>a.jsx("div",{ref:t,className:(0,n.cn)("flex items-center p-6 pt-0",e),...s})).displayName="CardFooter"},1190:(e,s,t)=>{"use strict";t.d(s,{I:()=>i});var a=t(326),r=t(7577),n=t(1223);let i=r.forwardRef(({className:e,type:s,...t},r)=>a.jsx("input",{type:s,className:(0,n.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:r,...t}));i.displayName="Input"},4794:(e,s,t)=>{"use strict";t.d(s,{_:()=>o});var a=t(326),r=t(7577),n=t(4478),i=t(9360),l=t(1223);let d=(0,i.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),o=r.forwardRef(({className:e,...s},t)=>a.jsx(n.f,{ref:t,className:(0,l.cn)(d(),e),...s}));o.displayName=n.f.displayName},2015:(e,s,t)=>{"use strict";t.d(s,{g:()=>i});var a=t(326),r=t(7577),n=t(1223);let i=r.forwardRef(({className:e,...s},t)=>a.jsx("textarea",{className:(0,n.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:t,...s}));i.displayName="Textarea"},6568:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>a});let a=(0,t(8570).createProxy)(String.raw`/Users/emmanuelakangbou/ai-ide/web-app/app/admin/indexing/page.tsx#default`)},4478:(e,s,t)=>{"use strict";t.d(s,{f:()=>l});var a=t(7577),r=t(5226),n=t(326),i=a.forwardRef((e,s)=>(0,n.jsx)(r.WV.label,{...e,ref:s,onMouseDown:s=>{s.target.closest("button, input, select, textarea")||(e.onMouseDown?.(s),!s.defaultPrevented&&s.detail>1&&s.preventDefault())}}));i.displayName="Label";var l=i}};var s=require("../../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),a=s.X(0,[150,242],()=>t(3684));module.exports=a})();